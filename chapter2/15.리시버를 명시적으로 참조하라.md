# ì•„ì´í…œ15. ë¦¬ì‹œë²„ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì°¸ì¡°í•˜ë¼

í•¨ìˆ˜ì™€ í”„ë¡œí¼í‹°ë¥¼ ì§€ì—­ ë˜ëŠ” í†±ë ˆë²¨ ë³€ìˆ˜ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ë¦¬ì‹œë²„ë¡œ ë¶€í„° ê°€ì ¸ì˜¨ë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚¼ ë•Œê°€ ìˆë‹¤.

```kotlin
class User: Person() {
    private var beersDrunk: Int = 0
    
    fun drinkBeers(num: Int) {
        // ...
        this.beersDrunk += num
        // ...
    }
}
```

```kotlin
fun <T : Comparable<T>> List<T>.quickSort(): List<T> {
    if (size < 2) return this
    val pivot = first()
    val (smaller, bigger) = drop(1)
        .partition { it < pivot }
    return smaller.quickSort() + pivot + bigger.quickSort()
}
```

```kotlin
fun <T : Comparable<T>> List<T>.quickSort(): List<T> {
    if (this.size < 2) return this
    val pivot = this.first()
    val (smaller, bigger) = this.drop(1)
        .partition { it < pivot }
    return smaller.quickSort() + pivot + bigger.quickSort()
}
```

```kotlin
class User: Person() {
    private var beersDrunk: Int = 0
    
    fun drinkBeers(num: Int) {
        // ...
        this.beersDrunk += num
        // ...
    }
}
```
ë‘ í•¨ìˆ˜ì˜ ì‚¬ìš©ì— ì°¨ì´ëŠ” ì—†ë‹¤.

<br>

## ğŸ“ ì—¬ëŸ¬ ê°œì˜ ë¦¬ì‹œë²„
ìŠ¤ì½”í”„ ë‚´ë¶€ì— ë‘˜ ì´ìƒì˜ ë¦¬ì‹œë²„ê°€ ìˆëŠ” ê²½ìš°, ë¦¬ì‹œë²„ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ì¢‹ë‹¤. apply, with, run í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•Œê°€ ëŒ€í‘œì ì¸ ì˜ˆì´ë‹¤.

```kotlin
class Node(val name: String){
    
    fun makeChild(child: String) {
        create("$name.$child")
            .apply { print("Created ${name}") }
    }

    fun create(name: String) = Node(name)
}

fun main() {
    val node = Node("parent")
    node.makeChild("child") // "Created Parent"
}
```
'Created parent.child'ë¥¼ ì˜ˆìƒí•˜ì§€ë§Œ 'Created parent' ê°€ ì¶œë ¥ëœë‹¤.

###
ë§Œì•½ì— also í•¨ìˆ˜ì™€ name íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í–ˆë‹¤ë©´ ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
```kotlin
class Node(val name: String){

    fun makeChild(child: String) {
        create("$name.$child")
            .also { print("Created ${it?.name}") }
    }

    fun create(name: String): Node? = Node(name)
}
```

ë ˆì´ë¸”ì´ ì—†ì´ ë¦¬ì‹œë²„ë¥¼ ì‚¬ìš©í•˜ë©´, ê°€ì¥ ê°€ê¹Œìš´ ë¦¬ì‹œë²„ë¥¼ ì˜ë¯¸í•œë‹¤. ì™¸ë¶€ì— ìˆëŠ” ë¦¬ì‹œë²„ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´, ë ˆì´ë¸”ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
```kotlin
class Node(val name: String){

    fun makeChild(child: String) {
        create("$name.$childName").apply { 
            print("Created ${this?.name} in " + " ${this@node.name}")
        }
    }

    fun create(name: String): Node? = Node(name)
    
    fun main() {
        val node = Node("parent")
        node.makeChild("child")
        // Created parent.child in parent
    }
}
```

##ğŸ“ DslMarker ì–´ë…¸í…Œì´ì…˜
ë‹¤ë§Œ DSL ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.
DSLì€ ì•„ë˜ì™€ ê°™ì´ ë¦¬ì‹œë²„ë¥¼ ìƒëµí•´ì„œ ì‚¬ìš©í•˜ëŠ”ê±¸ ì „ì œë¡œ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.
```kotlin
table {
    tr{
        td{ + "Column1"}
        td{ + "Column2"}
    }
    tr{
        td{ + "Value1"}
        td{ + "Value2"}
    }
}
```
ì˜ˆë¥¼ ë“¤ì–´ ê°™ì€ ì´ë¦„ì„ ê°€ì§„ `tr`ì´ë¼ëŠ” í•¨ìˆ˜ê°€ ì™¸ë¶€ ìŠ¤ì½”í”„ì— ìˆë‹¤ë©´, `this`ê°€ ìƒëµëœ ë‚´ ì½”ë“œê°€ ì–´ë–¤ `tr`ì„ ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œê¸° ì–´ë ¤ìš¸ ê²ƒì´ë‹¤.

ê·¸ë˜ì„œ ì½”í‹€ë¦°ì—ì„œëŠ” `DslMarker` ì–´ë…¸í…Œì´ì…˜ì„ ì œê³µí•œë‹¤.
```kotlin
@DslMarker
annotation class HtmlDsl
```
```kotlin
@HtmlDsl
class TableDsl { /*...*/ }

fun table(f: TableDsl.() -> Unit) { /*...*/ }
```


ì´ë¥¼ ì‚¬ìš©í•˜ë©´, `ì•”ë¬µì ìœ¼ë¡œ ì™¸ë¶€ìŠ¤ì½”í”„ì˜ ë¦¬ì‹œë²„ë¥¼ í˜¸ì¶œ`í•˜ê²Œë˜ë©´ ì»´íŒŒì¼ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

ë§Œì•½ ì™¸ë¶€ìŠ¤ì½”í”„ì— ìˆëŠ” ë™ì¼í•œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´, ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
```kotlin
table {
    tr{
        td{ + "Column1"}
        td{ + "Column2"}
    }
    this@table.tr{
        td{ + "Value1"}
        td{ + "Value2"}
    }
}
```

<br>

ğŸ“Œ ì°¸ê³ ë¡œ ëŒë‹¤í•¨ìˆ˜ì— `return` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œì—ë„ ë¹„ìŠ·í•˜ê²Œ ì“¸ ìˆ˜ ìˆë‹¤.
<details markdown="1">
<summary> ë”ë³´ê¸° </summary>

* ê¸°ë³¸ì ìœ¼ë¡œ `return` ì€ ëŒë‹¤ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì‚¬ìš©í•˜ë©´ `fun í•¨ìˆ˜`ì˜ ë°˜í™˜ê°’ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.
```kotlin
fun myFunc(){
    return list.flatMap{
        // ì´ë ‡ê²Œ ì‚¬ìš©í•˜ë©´ fun myFuncê°€ return listOf() ë˜ë²„ë¦°ë‹¤.
        if (it == 0) return listOf()
        listOf(it, it) // return ì´ ì‹¤í–‰ë˜ë©´ í•¨ìˆ˜ê°€ ì¢…ë£Œë˜ì–´ ë¬´ì‹œë˜ëŠ” ì½”ë“œ 
    }
}
```
- ì´ëŸ´ë• `return@name`ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
```kotlin
list.flatMap {
    if (it == 0) return@flatMap listOf<Int>()
    listOf(it, it)
}

list.flatMap my@{ // í˜¹ì€ ì´ë ‡ê²Œ ë³„ëª…ì„ ë‹¬ì•„ì¤˜ë„ ëœë‹¤.
    if (it == 0) return@my listOf<Int>()
    listOf(it, it)
}
```

</details>

### ì •ë¦¬ 
- ì§§ê²Œ ì ì„ ìˆ˜ ìˆë‹¤ëŠ” ì´ìœ ë§Œìœ¼ë¡œ ë¦¬ì‹œë²„ë¥¼ ì œê±°í•˜ì§€ ë§ë¼.
- ì—¬ëŸ¬ê°œì˜ ë¦¬ì‹œë²„ê°€ ìˆëŠ” ê²½ìš° ëª…ì‹œì ìœ¼ë¡œ ì ì–´ì£¼ì
- DSLì—ì„œ ì™¸ë¶€ ìŠ¤ì½”í”„ì— ìˆëŠ” ë¦¬ì‹œë²„ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì ê²Œ ê°•ì œí•˜ê³  ì‹¶ë‹¤ë©´, DslMarker ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œë‹¤.